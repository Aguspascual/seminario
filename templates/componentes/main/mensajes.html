<link rel="stylesheet" href="/static/css/componentes/main/mensajes.css">
<div class="containerMensajes">
    <div class="boxHeader">
        <h2>Mensajes</h2>
    </div>
    <div class="boxBody">
        <div class="mensajes" id="mensajesContainer">
            {% for chat in chats %}
                {% if chat.idEmisor == session.get('user_id') %}
                    <div class="mensajeInterno">
                        <div class="mensajeContenido">
                            <p>{{ chat.descripcion }}</p>
                            <p class="hora">{{ chat.fecha.strftime('%H:%M') }}</p>
                        </div>
                    </div>
                {% else %}
                    <div class="mensajeExterno">
                        <div class="mensajeContenido">
                            {% for usuario in usuarios %}
                                {% if usuario.id == chat.idEmisor %}
                                    <h5>{{ usuario.nombre }} {{ usuario.apellido }}</h5>
                                {% endif %}
                            {% endfor %}
                            <p>{{ chat.descripcion }}</p>
                            <p class="hora">{{ chat.fecha.strftime('%H:%M') }}</p>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        <div class="area">
            <form action="/mensajes/enviar" method="post">
                <input type="number" name="idReceptor" hidden value="{{ idReceptor }}">
                <input type="text" name="mensaje" placeholder="Escribe un mensaje">
                <button type="submit"><i class="fas fa-paper-plane"></i></button>
            </form>
        </div>
    </div>
</div>
<script>
    const mensajesContainer = document.getElementById('mensajesContainer');
    if (mensajesContainer) {
        mensajesContainer.scrollTop = mensajesContainer.scrollHeight;
    }
</script>